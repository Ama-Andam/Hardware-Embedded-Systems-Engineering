Day 4/365

Can't lie today was tough because I did something new, and I would probably have to redo everything tomorrow so I get a grasp of everything.
Today I used Yosys, which is Your Synthesis Suite, and this is an open source tool that is used to convert RTL to low-level netlists for FPGAs and ASICs

If I say I get what's going on here that would be a lie, but I am giving myself grace so I can take my time and understand everything here. 

Here is what I have learned as of today 4/365
When you have an RTL design right, you have the code in say verilog or system verilog, for me I designed it in  Multisim and so I know what it would look like in terms of logic gates, but assuming this was uhm say a vending machine or a traffic light controller.
When you begin you design it in RTL, how do you know how many logic gates are gonna be used, how do you know that its not gonna over use some gates and take too much power, how do you optimze the system.

That's the point of Yosys take your code and give the what you system would look like at the low level. It tells you:
	•	how big the hardware is
	•	how many gates it uses
	•	how much power it might use
	•	whether the design is wasteful

Different verilog codes design with the same instructions and hardware could give the same output in simulation but the hardware deisgn of both systems could be entirely different, and Yosys helps you compare these.
ASICs and FPGAs are platforms with thousands (or millions) of logic elements, and synthesis figures out how my RTL turns into actual logic that can be placed onto those elements.

I watched this Youtube video to start the Yosys stuff:
https://youtu.be/aQ-G5yFrfUk?si=IgCmUiXLUgj9CDzg


This is how it went in Linux:
manuela@manuela:~$ cd Documents/
manuela@manuela:~/Documents$ ls
RTL
manuela@manuela:~/Documents$ cd RTL/
manuela@manuela:~/Documents/RTL$ cd Basic\ Circuits/
manuela@manuela:~/Documents/RTL/Basic Circuits$ ls
a.out  fulladder.c  fulladder.v  halfadder.c  halfadder.v  testbench.v
manuela@manuela:~/Documents/RTL/Basic Circuits$ yosys

 /----------------------------------------------------------------------------\
 |                                                                            |
 |  yosys -- Yosys Open SYnthesis Suite                                       |
 |                                                                            |
 |  Copyright (C) 2012 - 2020  Claire Xenia Wolf <claire@yosyshq.com>         |
 |                                                                            |
 |  Permission to use, copy, modify, and/or distribute this software for any  |
 |  purpose with or without fee is hereby granted, provided that the above    |
 |  copyright notice and this permission notice appear in all copies.         |
 |                                                                            |
 |  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES  |
 |  WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF          |
 |  MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR   |
 |  ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES    |
 |  WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN     |
 |  ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF   |
 |  OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.            |
 |                                                                            |
 \----------------------------------------------------------------------------/

 Yosys 0.33 (git sha1 2584903a060)


yosys> read_verilog fulladder.v
1. Executing Verilog-2005 frontend: fulladder.v
Parsing Verilog input from `fulladder.v' to AST representation.
Generating RTLIL representation for module `\full_adder'.
Successfully finished Verilog frontend.

yosys> hierarchy -check -top fulladder 

2. Executing HIERARCHY pass (managing design hierarchy).
ERROR: Module `fulladder' not found!

yosys> hierarchy -check -top full_adder 

3. Executing HIERARCHY pass (managing design hierarchy).

3.1. Analyzing design hierarchy..
Top module:  \full_adder

3.2. Analyzing design hierarchy..
Top module:  \full_adder
Removed 0 unused modules.

yosys> proc

4. Executing PROC pass (convert processes to netlists).

4.1. Executing PROC_CLEAN pass (remove empty switches from decision trees).
Cleaned up 0 empty switches.

4.2. Executing PROC_RMDEAD pass (remove dead branches from decision trees).
Removed a total of 0 dead cases.

4.3. Executing PROC_PRUNE pass (remove redundant assignments in processes).
Removed 0 redundant assignments.
Promoted 0 assignments to connections.

4.4. Executing PROC_INIT pass (extract init attributes).

4.5. Executing PROC_ARST pass (detect async resets in processes).

4.6. Executing PROC_ROM pass (convert switches to ROMs).
Converted 0 switches.

4.7. Executing PROC_MUX pass (convert decision trees to multiplexers).

4.8. Executing PROC_DLATCH pass (convert process syncs to latches).

4.9. Executing PROC_DFF pass (convert process syncs to FFs).

4.10. Executing PROC_MEMWR pass (convert process memory writes to cells).

4.11. Executing PROC_CLEAN pass (remove empty switches from decision trees).
Cleaned up 0 empty switches.

4.12. Executing OPT_EXPR pass (perform const folding).
Optimizing module full_adder.

yosys> opt

5. Executing OPT pass (performing simple optimizations).

5.1. Executing OPT_EXPR pass (perform const folding).
Optimizing module full_adder.

5.2. Executing OPT_MERGE pass (detect identical cells).
Finding identical cells in module `\full_adder'.
Removed a total of 0 cells.

5.3. Executing OPT_MUXTREE pass (detect dead branches in mux trees).
Running muxtree optimizer on module \full_adder..
  Creating internal representation of mux trees.
  No muxes found in this module.
Removed 0 multiplexer ports.

5.4. Executing OPT_REDUCE pass (consolidate $*mux and $reduce_* inputs).
  Optimizing cells in module \full_adder.
Performed a total of 0 changes.

5.5. Executing OPT_MERGE pass (detect identical cells).
Finding identical cells in module `\full_adder'.
Removed a total of 0 cells.

5.6. Executing OPT_DFF pass (perform DFF optimizations).

5.7. Executing OPT_CLEAN pass (remove unused cells and wires).
Finding unused cells or wires in module \full_adder..
Removed 0 unused cells and 2 unused wires.
<suppressed ~1 debug messages>

5.8. Executing OPT_EXPR pass (perform const folding).
Optimizing module full_adder.

5.9. Rerunning OPT passes. (Maybe there is more to do..)

5.10. Executing OPT_MUXTREE pass (detect dead branches in mux trees).
Running muxtree optimizer on module \full_adder..
  Creating internal representation of mux trees.
  No muxes found in this module.
Removed 0 multiplexer ports.

5.11. Executing OPT_REDUCE pass (consolidate $*mux and $reduce_* inputs).
  Optimizing cells in module \full_adder.
Performed a total of 0 changes.

5.12. Executing OPT_MERGE pass (detect identical cells).
Finding identical cells in module `\full_adder'.
Removed a total of 0 cells.

5.13. Executing OPT_DFF pass (perform DFF optimizations).

5.14. Executing OPT_CLEAN pass (remove unused cells and wires).
Finding unused cells or wires in module \full_adder..

5.15. Executing OPT_EXPR pass (perform const folding).
Optimizing module full_adder.

5.16. Finished OPT passes. (There is nothing left to do.)

yosys> techmap

6. Executing TECHMAP pass (map to technology primitives).

6.1. Executing Verilog-2005 frontend: /usr/bin/../share/yosys/techmap.v
Parsing Verilog input from `/usr/bin/../share/yosys/techmap.v' to AST representation.
Generating RTLIL representation for module `\_90_simplemap_bool_ops'.
Generating RTLIL representation for module `\_90_simplemap_reduce_ops'.
Generating RTLIL representation for module `\_90_simplemap_logic_ops'.
Generating RTLIL representation for module `\_90_simplemap_compare_ops'.
Generating RTLIL representation for module `\_90_simplemap_various'.
Generating RTLIL representation for module `\_90_simplemap_registers'.
Generating RTLIL representation for module `\_90_shift_ops_shr_shl_sshl_sshr'.
Generating RTLIL representation for module `\_90_shift_shiftx'.
Generating RTLIL representation for module `\_90_fa'.
Generating RTLIL representation for module `\_90_lcu'.
Generating RTLIL representation for module `\_90_alu'.
Generating RTLIL representation for module `\_90_macc'.
Generating RTLIL representation for module `\_90_alumacc'.
Generating RTLIL representation for module `\$__div_mod_u'.
Generating RTLIL representation for module `\$__div_mod_trunc'.
Generating RTLIL representation for module `\_90_div'.
Generating RTLIL representation for module `\_90_mod'.
Generating RTLIL representation for module `\$__div_mod_floor'.
Generating RTLIL representation for module `\_90_divfloor'.
Generating RTLIL representation for module `\_90_modfloor'.
Generating RTLIL representation for module `\_90_pow'.
Generating RTLIL representation for module `\_90_pmux'.
Generating RTLIL representation for module `\_90_demux'.
Generating RTLIL representation for module `\_90_lut'.
Successfully finished Verilog frontend.

6.2. Continuing TECHMAP pass.
Using extmapper simplemap for cells of type $or.
Using extmapper simplemap for cells of type $and.
Using extmapper simplemap for cells of type $xor.
No more expansions possible.
<suppressed ~79 debug messages>

yosys> opt

7. Executing OPT pass (performing simple optimizations).

7.1. Executing OPT_EXPR pass (perform const folding).
Optimizing module full_adder.

7.2. Executing OPT_MERGE pass (detect identical cells).
Finding identical cells in module `\full_adder'.
Removed a total of 0 cells.

7.3. Executing OPT_MUXTREE pass (detect dead branches in mux trees).
Running muxtree optimizer on module \full_adder..
  Creating internal representation of mux trees.
  No muxes found in this module.
Removed 0 multiplexer ports.

7.4. Executing OPT_REDUCE pass (consolidate $*mux and $reduce_* inputs).
  Optimizing cells in module \full_adder.
Performed a total of 0 changes.

7.5. Executing OPT_MERGE pass (detect identical cells).
Finding identical cells in module `\full_adder'.
Removed a total of 0 cells.

7.6. Executing OPT_DFF pass (perform DFF optimizations).

7.7. Executing OPT_CLEAN pass (remove unused cells and wires).
Finding unused cells or wires in module \full_adder..

7.8. Executing OPT_EXPR pass (perform const folding).
Optimizing module full_adder.

7.9. Finished OPT passes. (There is nothing left to do.)

yosys> abc -g AND,OR,XOR

8. Executing ABC pass (technology mapping using ABC).

8.1. Extracting gate netlist of module `\full_adder' to `<abc-temp-dir>/input.blif'..
Extracted 6 gates and 9 wires to a netlist network with 3 inputs and 2 outputs.

8.1.1. Executing ABC.
Running ABC command: "<yosys-exe-dir>/yosys-abc" -s -f <abc-temp-dir>/abc.script 2>&1
ABC: ABC command line: "source <abc-temp-dir>/abc.script".
ABC: 
ABC: + read_blif <abc-temp-dir>/input.blif 
ABC: + read_library <abc-temp-dir>/stdcells.genlib 
ABC: Entered genlib library with 7 gates from file "<abc-temp-dir>/stdcells.genlib".
ABC: + strash 
ABC: + &get -n 
ABC: + &fraig -x 
ABC: + &put 
ABC: + scorr 
ABC: Warning: The network is combinational (run "fraig" or "fraig_sweep").
ABC: + dc2 
ABC: + dretime 
ABC: + strash 
ABC: + &get -n 
ABC: + &dch -f 
ABC: + &nf 
ABC: + &put 
ABC: + write_blif <abc-temp-dir>/output.blif 

8.1.2. Re-integrating ABC results.
ABC RESULTS:               AND cells:        2
ABC RESULTS:                OR cells:        2
ABC RESULTS:               XOR cells:        2
ABC RESULTS:        internal signals:        4
ABC RESULTS:           input signals:        3
ABC RESULTS:          output signals:        2
Removing temp directory.

yosys> stat

9. Printing statistics.

=== full_adder ===

   Number of wires:                 18
   Number of wire bits:             18
   Number of public wires:           5
   Number of public wire bits:       5
   Number of memories:               0
   Number of memory bits:            0
   Number of processes:              0
   Number of cells:                  6
     $_AND_                          2
     $_OR_                           2
     $_XOR_                          2


yosys> show
10. Generating Graphviz representation of design.
Writing dot description to `/home/manuela/.yosys_show.dot'.
Dumping module full_adder to page 1.
Exec: { test -f '/home/manuela/.yosys_show.dot.pid' && fuser -s '/home/manuela/.yosys_show.dot.pid' 2> /dev/null; } || ( echo $$ >&3; exec xdot '/home/manuela/.yosys_show.dot'; ) 3> '/home/manuela/.yosys_show.dot.pid' &

yosys> /usr/lib/python3/dist-packages/xdot/ui/elements.py:174: UserWarning: Font family 'Times-Roman' is not available, using 'Ubuntu Sans 11'
  warnings.warn(msg)


yosys> write_verilog fulladder_synth.v

11. Executing Verilog backend.

11.1. Executing BMUXMAP pass.

11.2. Executing DEMUXMAP pass.
Dumping module `\full_adder'.

yosys> read_verilog halfadder.v

12. Executing Verilog-2005 frontend: halfadder.v
Parsing Verilog input from `halfadder.v' to AST representation.
Generating RTLIL representation for module `\half_adder'.
Successfully finished Verilog frontend.

yosys> hierarchy -check -top halfadder

13. Executing HIERARCHY pass (managing design hierarchy).
ERROR: Module `halfadder' not found!

yosys> hierarchy -check -top half_adder

14. Executing HIERARCHY pass (managing design hierarchy).

14.1. Analyzing design hierarchy..
Top module:  \half_adder

14.2. Analyzing design hierarchy..
Top module:  \half_adder
Removing unused module `\full_adder'.
Removed 1 unused modules.

yosys> proc

15. Executing PROC pass (convert processes to netlists).

15.1. Executing PROC_CLEAN pass (remove empty switches from decision trees).
Cleaned up 0 empty switches.

15.2. Executing PROC_RMDEAD pass (remove dead branches from decision trees).
Removed a total of 0 dead cases.

15.3. Executing PROC_PRUNE pass (remove redundant assignments in processes).
Removed 0 redundant assignments.
Promoted 0 assignments to connections.

15.4. Executing PROC_INIT pass (extract init attributes).

15.5. Executing PROC_ARST pass (detect async resets in processes).

15.6. Executing PROC_ROM pass (convert switches to ROMs).
Converted 0 switches.

15.7. Executing PROC_MUX pass (convert decision trees to multiplexers).

15.8. Executing PROC_DLATCH pass (convert process syncs to latches).

15.9. Executing PROC_DFF pass (convert process syncs to FFs).

15.10. Executing PROC_MEMWR pass (convert process memory writes to cells).

15.11. Executing PROC_CLEAN pass (remove empty switches from decision trees).
Cleaned up 0 empty switches.

15.12. Executing OPT_EXPR pass (perform const folding).
Optimizing module half_adder.

yosys> opt

16. Executing OPT pass (performing simple optimizations).

16.1. Executing OPT_EXPR pass (perform const folding).
Optimizing module half_adder.

16.2. Executing OPT_MERGE pass (detect identical cells).
Finding identical cells in module `\half_adder'.
Removed a total of 0 cells.

16.3. Executing OPT_MUXTREE pass (detect dead branches in mux trees).
Running muxtree optimizer on module \half_adder..
  Creating internal representation of mux trees.
  No muxes found in this module.
Removed 0 multiplexer ports.

16.4. Executing OPT_REDUCE pass (consolidate $*mux and $reduce_* inputs).
  Optimizing cells in module \half_adder.
Performed a total of 0 changes.

16.5. Executing OPT_MERGE pass (detect identical cells).
Finding identical cells in module `\half_adder'.
Removed a total of 0 cells.

16.6. Executing OPT_DFF pass (perform DFF optimizations).

16.7. Executing OPT_CLEAN pass (remove unused cells and wires).
Finding unused cells or wires in module \half_adder..
Removed 0 unused cells and 2 unused wires.
<suppressed ~1 debug messages>

16.8. Executing OPT_EXPR pass (perform const folding).
Optimizing module half_adder.

16.9. Rerunning OPT passes. (Maybe there is more to do..)

16.10. Executing OPT_MUXTREE pass (detect dead branches in mux trees).
Running muxtree optimizer on module \half_adder..
  Creating internal representation of mux trees.
  No muxes found in this module.
Removed 0 multiplexer ports.

16.11. Executing OPT_REDUCE pass (consolidate $*mux and $reduce_* inputs).
  Optimizing cells in module \half_adder.
Performed a total of 0 changes.

16.12. Executing OPT_MERGE pass (detect identical cells).
Finding identical cells in module `\half_adder'.
Removed a total of 0 cells.

16.13. Executing OPT_DFF pass (perform DFF optimizations).

16.14. Executing OPT_CLEAN pass (remove unused cells and wires).
Finding unused cells or wires in module \half_adder..

16.15. Executing OPT_EXPR pass (perform const folding).
Optimizing module half_adder.

16.16. Finished OPT passes. (There is nothing left to do.)

yosys> techmap

17. Executing TECHMAP pass (map to technology primitives).

17.1. Executing Verilog-2005 frontend: /usr/bin/../share/yosys/techmap.v
Parsing Verilog input from `/usr/bin/../share/yosys/techmap.v' to AST representation.
Generating RTLIL representation for module `\_90_simplemap_bool_ops'.
Generating RTLIL representation for module `\_90_simplemap_reduce_ops'.
Generating RTLIL representation for module `\_90_simplemap_logic_ops'.
Generating RTLIL representation for module `\_90_simplemap_compare_ops'.
Generating RTLIL representation for module `\_90_simplemap_various'.
Generating RTLIL representation for module `\_90_simplemap_registers'.
Generating RTLIL representation for module `\_90_shift_ops_shr_shl_sshl_sshr'.
Generating RTLIL representation for module `\_90_shift_shiftx'.
Generating RTLIL representation for module `\_90_fa'.
Generating RTLIL representation for module `\_90_lcu'.
Generating RTLIL representation for module `\_90_alu'.
Generating RTLIL representation for module `\_90_macc'.
Generating RTLIL representation for module `\_90_alumacc'.
Generating RTLIL representation for module `\$__div_mod_u'.
Generating RTLIL representation for module `\$__div_mod_trunc'.
Generating RTLIL representation for module `\_90_div'.
Generating RTLIL representation for module `\_90_mod'.
Generating RTLIL representation for module `\$__div_mod_floor'.
Generating RTLIL representation for module `\_90_divfloor'.
Generating RTLIL representation for module `\_90_modfloor'.
Generating RTLIL representation for module `\_90_pow'.
Generating RTLIL representation for module `\_90_pmux'.
Generating RTLIL representation for module `\_90_demux'.
Generating RTLIL representation for module `\_90_lut'.
Successfully finished Verilog frontend.

17.2. Continuing TECHMAP pass.
Using extmapper simplemap for cells of type $and.
Using extmapper simplemap for cells of type $xor.
No more expansions possible.
<suppressed ~75 debug messages>

yosys> opt

18. Executing OPT pass (performing simple optimizations).

18.1. Executing OPT_EXPR pass (perform const folding).
Optimizing module half_adder.

18.2. Executing OPT_MERGE pass (detect identical cells).
Finding identical cells in module `\half_adder'.
Removed a total of 0 cells.

18.3. Executing OPT_MUXTREE pass (detect dead branches in mux trees).
Running muxtree optimizer on module \half_adder..
  Creating internal representation of mux trees.
  No muxes found in this module.
Removed 0 multiplexer ports.

18.4. Executing OPT_REDUCE pass (consolidate $*mux and $reduce_* inputs).
  Optimizing cells in module \half_adder.
Performed a total of 0 changes.

18.5. Executing OPT_MERGE pass (detect identical cells).
Finding identical cells in module `\half_adder'.
Removed a total of 0 cells.

18.6. Executing OPT_DFF pass (perform DFF optimizations).

18.7. Executing OPT_CLEAN pass (remove unused cells and wires).
Finding unused cells or wires in module \half_adder..

18.8. Executing OPT_EXPR pass (perform const folding).
Optimizing module half_adder.

18.9. Finished OPT passes. (There is nothing left to do.)

yosys> abc -g AND,OR,XOR

19. Executing ABC pass (technology mapping using ABC).

19.1. Extracting gate netlist of module `\half_adder' to `<abc-temp-dir>/input.blif'..
Extracted 2 gates and 4 wires to a netlist network with 2 inputs and 2 outputs.

19.1.1. Executing ABC.
Running ABC command: "<yosys-exe-dir>/yosys-abc" -s -f <abc-temp-dir>/abc.script 2>&1
ABC: ABC command line: "source <abc-temp-dir>/abc.script".
ABC: 
ABC: + read_blif <abc-temp-dir>/input.blif 
ABC: + read_library <abc-temp-dir>/stdcells.genlib 
ABC: Entered genlib library with 7 gates from file "<abc-temp-dir>/stdcells.genlib".
ABC: + strash 
ABC: + &get -n 
ABC: + &fraig -x 
ABC: + &put 
ABC: + scorr 
ABC: Warning: The network is combinational (run "fraig" or "fraig_sweep").
ABC: + dc2 
ABC: + dretime 
ABC: + strash 
ABC: + &get -n 
ABC: + &dch -f 
ABC: + &nf 
ABC: + &put 
ABC: + write_blif <abc-temp-dir>/output.blif 

19.1.2. Re-integrating ABC results.
ABC RESULTS:               AND cells:        1
ABC RESULTS:               XOR cells:        1
ABC RESULTS:        internal signals:        0
ABC RESULTS:           input signals:        2
ABC RESULTS:          output signals:        2
Removing temp directory.

yosys> stat

20. Printing statistics.

=== half_adder ===

   Number of wires:                  8
   Number of wire bits:              8
   Number of public wires:           4
   Number of public wire bits:       4
   Number of memories:               0
   Number of memory bits:            0
   Number of processes:              0
   Number of cells:                  2
     $_AND_                          1
     $_XOR_                          1


yosys> show
21. Generating Graphviz representation of design.
Writing dot description to `/home/manuela/.yosys_show.dot'.
Dumping module half_adder to page 1.
Exec: { test -f '/home/manuela/.yosys_show.dot.pid' && fuser -s '/home/manuela/.yosys_show.dot.pid' 2> /dev/null; } || ( echo $$ >&3; exec xdot '/home/manuela/.yosys_show.dot'; ) 3> '/home/manuela/.yosys_show.dot.pid' &

yosys> /usr/lib/python3/dist-packages/xdot/ui/elements.py:174: UserWarning: Font family 'Times-Roman' is not available, using 'Ubuntu Sans 11'
  warnings.warn(msg)


yosys> write_verilog halfadder_synth.v

22. Executing Verilog backend.

22.1. Executing BMUXMAP pass.

22.2. Executing DEMUXMAP pass.
Dumping module `\half_adder'.

yosys> show

23. Generating Graphviz representation of design.
Writing dot description to `/home/manuela/.yosys_show.dot'.
Dumping module half_adder to page 1.
Exec: { test -f '/home/manuela/.yosys_show.dot.pid' && fuser -s '/home/manuela/.yosys_show.dot.pid' 2> /dev/null; } || ( echo $$ >&3; exec xdot '/home/manuela/.yosys_show.dot'; ) 3> '/home/manuela/.yosys_show.dot.pid' &

yosys> /usr/lib/python3/dist-packages/xdot/ui/elements.py:174: UserWarning: Font family 'Times-Roman' is not available, using 'Ubuntu Sans 11'
  warnings.warn(msg)


yosys> 


